🚀 VERONA CARD HPC OTTIMIZZATO
==============================
Job ID: 19280671
Nodo: lrdn0611.leonardo.local
Data: Sat Aug 23 07:59:02 CEST 2025
🎯 Modalità: Produzione ottimizzata (4x A100, rate-limited)

📦 Setup ambiente HPC...
Loading python/3.11.6--gcc--8.5.0
  Loading requirement: bzip2/1.0.8-gp5wcz5 libmd/1.0.4-wja3f5q
    libbsd/0.11.7-cgxjopl expat/2.5.0-bptl3xw ncurses/6.4-asx3jea
    readline/8.2-nyw6mp6 gdbm/1.23-fs6otck libiconv/1.17-d7yvx2s
    xz/5.4.1-hubmwr5 zlib-ng/2.1.4-6htiapk libxml2/2.10.3-5eeeokp
    pigz/2.7-bopr5vp zstd/1.5.5-gawytfl tar/1.34-amqus5s gettext/0.22.3-2g7elif
    libffi/3.4.4-6r7brdq libxcrypt/4.4.35-ss2rzin sqlite/3.43.2
    util-linux-uuid/2.38.1-jkdi7kv
✅ Python: Python 3.11.6
✅ CUDA: Cuda compilation tools, release 12.3, V12.3.103

🔍 GPU DETECTION:
0, NVIDIA A100-SXM-64GB, 65536 MiB, 43
1, NVIDIA A100-SXM-64GB, 65536 MiB, 43
2, NVIDIA A100-SXM-64GB, 65536 MiB, 43
3, NVIDIA A100-SXM-64GB, 65536 MiB, 42
SLURM GPUs: 4

🚀 Avvio server Ollama ottimizzato (4x GPU)...
🔍 Controllo stato GPU...
0, NVIDIA A100-SXM-64GB, 2 MiB, 43
1, NVIDIA A100-SXM-64GB, 2 MiB, 43
2, NVIDIA A100-SXM-64GB, 2 MiB, 43
3, NVIDIA A100-SXM-64GB, 2 MiB, 42
# gpu         pid  type    sm    mem    enc    dec    command
# Idx           #   C/G     %      %      %      %    name
    0          -     -     -     -     -     -   -              
    1          -     -     -     -     -     -   -              
    2          -     -     -     -     -     -   -              
    3          -     -     -     -     -     -   -              
🔥 Avvio istanza GPU 0 su porta 39001...
✅ GPU 0 PID: 961273
🔥 Avvio istanza GPU 1 su porta 39002...
✅ GPU 1 PID: 961303
🔥 Avvio istanza GPU 2 su porta 39003...
✅ GPU 2 PID: 961333
🔥 Avvio istanza GPU 3 su porta 39004...
✅ GPU 3 PID: 961360
✅ Tutte le istanze avviate:
   GPU 0: PID 249 (porta 39001)
   GPU 1: PID 23 (porta 39002)
   GPU 2: PID 53 (porta 39003)
   GPU 3: PID 80 (porta 39004)

⏳ Verifica health multi-istanza...
🔍 Check GPU 0 (porta 39001)...
✅ GPU 0 operativa
🔍 Check GPU 1 (porta 39002)...
✅ GPU 1 operativa
🔍 Check GPU 2 (porta 39003)...
✅ GPU 2 operativa
🔍 Check GPU 3 (porta 39004)...
✅ GPU 3 operativa
📊 Health check: 4/4 istanze operative

📥 Preparazione modello su tutte le GPU...
🔍 Verifica modello mixtral:8x7b...
🔥 Pre-caricamento distribuito...
⚡ Warm-up GPU 0...
⚡ Warm-up GPU 1...
⚡ Warm-up GPU 2...
🚨 DEBUG: PIDs preload salvati: 961430 961431 961432 961434
⏳ Attesa completamento preload (max 120s)...
⚡ Warm-up GPU 3...
⏳ Preload in corso... (4/4 attivi, 0s)
✅ GPU 0 pronta
✅ GPU 3 pronta
✅ GPU 1 pronta
✅ GPU 2 pronta
✅ Tutti i preload completati in 12s
🔍 DEBUG: Stato finale preload:
  PID 961430: TERMINATO
  PID 961431: TERMINATO
  PID 961432: TERMINATO
  PID 961434: TERMINATO

🔍 DEBUG: Punto critico post warm-up
Timestamp: 2025-08-23 08:00:22
Uptime processo: 80 secondi
Directory corrente: /leonardo_work/IscrC_LLM-Mob/LLM-Mob-As-Mobility-Interpreter
Spazio disco disponibile: 10.128.82.1@o2ib:10.128.82.2@o2ib:/larchive/work  1.0T   90G  935G   9% /leonardo_work
Memoria disponibile:               total        used        free      shared  buff/cache   available
Mem:          502Gi       4.2Gi       492Gi        97Mi       5.9Gi       491Gi
Swap:            0B          0B          0B

📋 DEBUG: Verifica ambiente Python
File Python esiste: -rw-r--r-- 1 smattiol interactive 62275 Aug 22 22:32 veronacard_mob_with_geom_parrallel.py
Directory data: DIRECTORY NON TROVATA
File input: FILE NON TROVATO

🧪 DEBUG: Test Python veloce
Python path: /leonardo_work/IscrC_LLM-Mob/venv/bin/python3
✅ Pandas OK
✅ Requests OK
✅ Python base OK

🔍 DEBUG: Stato processi Ollama
❌ PID 249 terminato
❌ PID 23 terminato
❌ PID 53 terminato
❌ PID 80 terminato

🌐 DEBUG: Test connettività finale
✅ Porta 39001 risponde
✅ Porta 39002 risponde
✅ Porta 39003 risponde
✅ Porta 39004 risponde

🎯 DEBUG: Inizio sezione Python
===============================================

🎯 AVVIO ELABORAZIONE OTTIMIZZATA
================================
📊 Configurazione finale:
   🎯 GPU operative: 4/4
   ⚡ Rate limit: 4 richieste concurrent
   💾 Salvataggio incrementale: ogni 100 carte
   🔄 Timeout richiesta: 240s
   🛡️ Circuit breaker: attivo

📍 Directory dopo cd: /leonardo_work/IscrC_LLM-Mob/LLM-Mob-As-Mobility-Interpreter
📁 Contenuto directory:
total 7292
drwxr-xr-x 24 smattiol interactive      4096 Aug 23 07:59 .
drwxrwx--- 10 smattiol IscrC_LLM-Mob    4096 Aug 15 18:50 ..
drwxr-xr-x  2 smattiol interactive      4096 Aug 22 16:51 BACK UP FUNZIONANTE PARALLEL
drwxr-xr-x  6 smattiol interactive      4096 Aug 15 18:41 data
drwxr-xr-x  4 smattiol interactive      4096 Aug 20 09:58 DOCUMENTAZIONE UFFICIALE
-rw-r--r--  1 smattiol interactive      8196 Aug 15 18:41 .DS_Store
-rw-r--r--  1 smattiol interactive        29 Aug 22 14:52 fatti.tzt
drwxr-xr-x  5 smattiol interactive      4096 Aug 15 18:41 file llm-Mob
drwxr-xr-x  8 smattiol interactive      4096 Aug 22 15:55 .git
📂 Directory results creata: drwxr-xr-x 2 smattiol interactive 4096 Aug 22 23:27 results/
🚀 Avvio script Python ottimizzato...
📄 File target: veronacard_2023_original_parziale.csv
⏰ Timestamp inizio: 2025-08-23 08:00:40

🔍 DEBUG: Test comando Python (dry run)
✅ Argomenti Python parsati correttamente
   File: veronacard_2020_2023/veronacard_2022_original.csv
   Append: False

🎬 INIZIO ESECUZIONE PYTHON REALE
- BACK UP FUNZIONANTE PARALLEL data DOCUMENTAZIONE UFFICIALE fatti.tzt file llm-Mob hpc_verona_optimized.log img LICENSE logs mini run con geometrie da MACBOOK notebook ollama_config.json ollama_gpu0.log ollama_gpu1.log ollama_gpu2.log ollama_gpu3.log ollama_info.txt ollama_models.txt ollama_ports.txt ollama_port.txt ollama_production.log PARALLEL MAX PERFORMANCE parallel_production_run_4_GPU.sh parallel_production_run.sh prima run di DEBUG with geom da Leonardo production_run.sh python_execution.log README.md requirements.txt result_run_completa_with_geom_srv_univr results results_2025_05_10_(_prima_run_su_srv_univr_LITE_) results_leo_with_geom_n-1_come_current_POI results_leo_with_geom_parziali results_parziali_ministral results semi-completi ministral results_short results_srv_univr_(_no_SPACE-GEO_n-1_come_current_POI_) slurm-19273279.out slurm-19273315.out slurm-19273358.out slurm-19273815.out slurm-19273934.out slurm-19280671.out venv veronacard_mob.py veronacard_mob_versione_base.py veronacard_mob_with_geom_parrallel.py veronacard_mob_with_geom.py 50
2025-08-23 08:01:08,284 INFO: 🔥 Configurazione multi-GPU: 4 istanze
2025-08-23 08:01:08,284 INFO: 🎯 Configurazione caricata: 4 host
Controllo host 1/4: http://127.0.0.1:39001
Attesa Ollama su http://127.0.0.1:39001...
✓ http://127.0.0.1:39001 risponde con status 200
✓ http://127.0.0.1:39001 completamente attivo
Controllo host 2/4: http://127.0.0.1:39002
Attesa Ollama su http://127.0.0.1:39002...
✓ http://127.0.0.1:39002 risponde con status 200
✓ http://127.0.0.1:39002 completamente attivo
Controllo host 3/4: http://127.0.0.1:39003
Attesa Ollama su http://127.0.0.1:39003...
✓ http://127.0.0.1:39003 risponde con status 200
✓ http://127.0.0.1:39003 completamente attivo
Controllo host 4/4: http://127.0.0.1:39004
Attesa Ollama su http://127.0.0.1:39004...
✓ http://127.0.0.1:39004 risponde con status 200
✓ http://127.0.0.1:39004 completamente attivo
Tutti gli 4 host Ollama sono pronti!
🎉 Connessione Ollama stabilita con successo!
2025-08-23 08:01:08,388 INFO: Test http://127.0.0.1:39001...
2025-08-23 08:02:08,475 ERROR: http://127.0.0.1:39001 non funziona
2025-08-23 08:02:08,475 INFO: Test http://127.0.0.1:39002...
📊 [08:02:43] Progress: 6 files (1 new), 44M total
🔧 [08:02:43] GPU Status:
   GPU0:    6MB  0%  43°C (idle?)
   GPU1:  482MB  0%  44°C (idle?)
   GPU2:    6MB  0%  43°C (idle?)
   GPU3:    6MB  0%  43°C (idle?)
---
2025-08-23 08:03:08,564 ERROR: http://127.0.0.1:39002 non funziona
2025-08-23 08:03:08,564 INFO: Test http://127.0.0.1:39003...
