ğŸš€ LLM-MOB PRODUCTION RUN - TUTTI GLI UTENTI
=============================================
Job ID: 18855513
Nodo: lrdn0036.leonardo.local
Data: Wed Aug 13 13:54:01 CEST 2025
ğŸ’¡ MODALITÃ€: Processamento completo senza limiti utenti

ğŸ“¦ Caricamento moduli e ambiente...
Loading python/3.11.6--gcc--8.5.0
  Loading requirement: bzip2/1.0.8-gp5wcz5 libmd/1.0.4-wja3f5q
    libbsd/0.11.7-cgxjopl expat/2.5.0-bptl3xw ncurses/6.4-asx3jea
    readline/8.2-nyw6mp6 gdbm/1.23-fs6otck libiconv/1.17-d7yvx2s
    xz/5.4.1-hubmwr5 zlib-ng/2.1.4-6htiapk libxml2/2.10.3-5eeeokp
    pigz/2.7-bopr5vp zstd/1.5.5-gawytfl tar/1.34-amqus5s gettext/0.22.3-2g7elif
    libffi/3.4.4-6r7brdq libxcrypt/4.4.35-ss2rzin sqlite/3.43.2
    util-linux-uuid/2.38.1-jkdi7kv
âœ“ Python: Python 3.11.6
âœ“ Virtual env: /leonardo/home/userexternal/smattiol/LLM-Mob-As-Mobility-Interpreter/llm
âœ“ CUDA: Cuda compilation tools, release 12.3, V12.3.103

ğŸ” INFO GPU:
name, memory.total [MiB], memory.used [MiB], utilization.gpu [%], temperature.gpu
NVIDIA A100-SXM-64GB, 65536 MiB, 2 MiB, 0 %, 43
CUDA_VISIBLE_DEVICES: 0

âš™ï¸  Configurazione Ollama...
âœ“ Versione Ollama: 0.3.14

ğŸš€ Avvio server Ollama per produzione...
âœ“ Porta server: 39003
ğŸ§¹ Pulizia processi precedenti...
âœ“ Server PID: 3297029
âœ“ Log file: ollama_production.log

â³ Attesa avvio server (max 60s)...
âœ… Server operativo dopo 10s

ğŸ”¥ Preparazione modello per produzione...
ğŸ“‹ Modelli disponibili:
  âœ“ deepseek-coder:33b
  âœ“ qwen2.5:72b
  âœ“ mixtral:8x7b
  âœ“ llama3.1:70b
  âœ“ llama3.1:8b
âœ… Modello llama3.1:8b disponibile

ğŸ¯ AVVIO PRODUZIONE - PROCESSAMENTO COMPLETO
=============================================
âœ… Configurazione produzione attiva
ğŸ“Š Nessun limite utenti - processamento completo
â±ï¸  Tempo stimato: variabile (dipende dai dati)
ğŸ”„ Retry automatici: 5 tentativi per richiesta

ğŸ“¦ Verifica dipendenze Python...
ğŸ“ Directory risultati: /leonardo/home/userexternal/smattiol/LLM-Mob-As-Mobility-Interpreter/results/
ğŸš€ AVVIO SCRIPT PRODUZIONE...
ğŸ“ Log dettagliato disponibile in tempo reale

2025-08-13 13:54:46,546 INFO: âœ… Ollama test passed - Response: 'How'
ğŸ‘‰ Porta letta da ollama_port.txt: '39003'
ğŸ‘‰ Provo a contattare http://127.0.0.1:39003/api/tags
ğŸ“‚ Working dir: /leonardo/home/userexternal/smattiol/LLM-Mob-As-Mobility-Interpreter
ğŸ“„ Contenuto di ollama_port.txt: '39003'
ğŸ”„ Attesa Ollama su http://127.0.0.1:39003...
âœ“ Ollama risponde con status 200
âœ“ Runner LLaMA completamente attivo
ğŸ‰ Connessione Ollama stabilita con successo!
Traceback (most recent call last):
  File "/leonardo/home/userexternal/smattiol/LLM-Mob-As-Mobility-Interpreter/veronacard_mob_with_geom.py", line 1008, in <module>
    run_all_verona_logs(max_users=args.max_users,
  File "/leonardo/home/userexternal/smattiol/LLM-Mob-As-Mobility-Interpreter/veronacard_mob_with_geom.py", line 896, in run_all_verona_logs
    run_on_visits_file(csv, poi_csv,
  File "/leonardo/home/userexternal/smattiol/LLM-Mob-As-Mobility-Interpreter/veronacard_mob_with_geom.py", line 856, in run_on_visits_file
    for cid in tqdm(demo_cards, desc="Card", unit="card"):
                    ^^^^^^^^^^
NameError: name 'demo_cards' is not defined

âŒ ERRORE IN PRODUZIONE (exit code: 1)
â±ï¸  Tempo prima del fallimento: 7 secondi
âš ï¸  Errore generico - controllare log

ğŸ“‹ REPORT FINALE PRODUZIONE
============================
â±ï¸  Tempo totale job: 45 secondi (0h 0m)
ğŸ”§ Versione Ollama: 0.3.14
ğŸ“Š ModalitÃ : Produzione completa (tutti gli utenti)
/var/spool/slurmd/job18855513/slurm_script: line 330: 3297081 Terminated              monitor_progress
âœ… Python success: false

ğŸ“ RISULTATI GENERATI:
   ğŸ“Š Total files: 3
   ğŸ’¾ Total size: 46M

   ğŸ“‹ File generati:
     -rw-r--r-- 1 smattiol interactive 15M Aug  7 14:36 results/dati_2014_pred_20250806_180856.csv
     -rw-r--r-- 1 smattiol interactive 16M Aug  8 14:52 results/dati_2015_pred_20250807_181256.csv
     -rw-r--r-- 1 smattiol interactive 16M Aug  9 15:37 results/dati_2016_pred_20250808_175223.csv

ğŸ”§ STATO FINALE SISTEMA:
memory.used [MiB], memory.total [MiB], utilization.gpu [%], temperature.gpu
5766 MiB, 65536 MiB, 9 %, 44

ğŸ“Š LOG OLLAMA (ultimi 20 righe):
llm_load_tensors: offloading non-repeating layers to GPU
llm_load_tensors: offloaded 33/33 layers to GPU
llm_load_tensors:        CPU buffer size =   281.81 MiB
llm_load_tensors:      CUDA0 buffer size =  4403.50 MiB
llama_new_context_with_model: n_ctx      = 4096
llama_new_context_with_model: n_batch    = 512
llama_new_context_with_model: n_ubatch   = 512
llama_new_context_with_model: flash_attn = 0
llama_new_context_with_model: freq_base  = 500000.0
llama_new_context_with_model: freq_scale = 1
llama_kv_cache_init:      CUDA0 KV buffer size =   512.00 MiB
llama_new_context_with_model: KV self size  =  512.00 MiB, K (f16):  256.00 MiB, V (f16):  256.00 MiB
llama_new_context_with_model:  CUDA_Host  output buffer size =     1.01 MiB
llama_new_context_with_model:      CUDA0 compute buffer size =   296.00 MiB
llama_new_context_with_model:  CUDA_Host compute buffer size =    16.01 MiB
llama_new_context_with_model: graph nodes  = 1030
llama_new_context_with_model: graph splits = 2
INFO [main] model loaded | tid="22367020179456" timestamp=1755086086
time=2025-08-13T13:54:46.439+02:00 level=INFO source=server.go:626 msg="llama runner started in 5.27 seconds"
[GIN] 2025/08/13 - 13:54:46 | 200 |  5.612034055s |       127.0.0.1 | POST     "/api/generate"

âš ï¸ JOB PRODUZIONE TERMINATO CON ERRORI
ğŸ“‹ Verificare log per dettagli specifici

ğŸ Fine job: Wed Aug 13 13:54:46 CEST 2025
=============================================

ğŸ§¹ CLEANUP PRODUZIONE...
ğŸ• Tempo totale job: 45 secondi (0h 0m)
ğŸ“Š Stato GPU finale:
memory.used [MiB], memory.total [MiB], utilization.gpu [%], temperature.gpu
5766 MiB, 65536 MiB, 9 %, 44
ğŸ“ Risultati generati: 3 files
ğŸ’¾ Dimensione risultati: 46M
ğŸ”„ Shutdown graceful Ollama...
âœ“ Cleanup completato
