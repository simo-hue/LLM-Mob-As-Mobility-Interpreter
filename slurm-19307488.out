🚀 VERONA CARD - UNLIMITED WAIT VERSION
================================================
⚠️ ATTENZIONE: Questo script aspetterà INDEFINITAMENTE il caricamento
Job ID: 19307488
Nodo: lrdn2292.leonardo.local
Data: Sun Aug 24 21:08:43 CEST 2025

📦 Setup ambiente HPC...
Loading python/3.11.6--gcc--8.5.0
  Loading requirement: bzip2/1.0.8-gp5wcz5 libmd/1.0.4-wja3f5q
    libbsd/0.11.7-cgxjopl expat/2.5.0-bptl3xw ncurses/6.4-asx3jea
    readline/8.2-nyw6mp6 gdbm/1.23-fs6otck libiconv/1.17-d7yvx2s
    xz/5.4.1-hubmwr5 zlib-ng/2.1.4-6htiapk libxml2/2.10.3-5eeeokp
    pigz/2.7-bopr5vp zstd/1.5.5-gawytfl tar/1.34-amqus5s gettext/0.22.3-2g7elif
    libffi/3.4.4-6r7brdq libxcrypt/4.4.35-ss2rzin sqlite/3.43.2
    util-linux-uuid/2.38.1-jkdi7kv
✅ Python: Python 3.11.6
✅ CUDA: Cuda compilation tools, release 12.3, V12.3.103

🔍 GPU DETECTION:
0, NVIDIA A100-SXM-64GB, 65536 MiB, 43
1, NVIDIA A100-SXM-64GB, 65536 MiB, 43
2, NVIDIA A100-SXM-64GB, 65536 MiB, 42
3, NVIDIA A100-SXM-64GB, 65536 MiB, 43

📁 Directory temporanea: /leonardo_work/IscrC_LLM-Mob/tmp_ollama_19307488
💾 Spazio disponibile: 951GB

🧹 Cleanup preventivo...

🚀 AVVIO SISTEMA OLLAMA
========================

🔧 Avvio GPU 0 su porta 39001...
✅ GPU 0 PID: 3581664 (NO TIMEOUT)
⏳ GPU 0 è MASTER - attesa caricamento modello SENZA LIMITI...
   🌐 API risponde, test modello...
   ✅ GPU 0 PRONTA dopo 1 tentativi!

✅ GPU 0 completamente operativa con modello caricato
⏳ Pausa 60s per stabilizzazione...

🚀 Avvio GPU secondarie...

🔧 Avvio GPU 1 su porta 39002...
✅ GPU 1 PID: 3581994 (NO TIMEOUT)

🔧 Avvio GPU 2 su porta 39003...
✅ GPU 2 PID: 3582034 (NO TIMEOUT)

🔧 Avvio GPU 3 su porta 39004...
✅ GPU 3 PID: 3582072 (NO TIMEOUT)
⏳ Attesa finale stabilizzazione sistema (60s)...

🔍 VERIFICA FINALE SISTEMA
===========================
GPU 0 (porta 39001): ✅ OPERATIVA
GPU 1 (porta 39002): ✅ OPERATIVA
GPU 2 (porta 39003): ✅ OPERATIVA
GPU 3 (porta 39004): ✅ OPERATIVA

📊 RISULTATO: 4/4 GPU operative
✅ Porte salvate: 39001,39002,39003,39004
📊 Starting Advanced GPU Monitor (ogni 60s)

🐍 AVVIO PYTHON
===============
File: data/verona/veronacard_2022_original.csv

2025-08-24 21:15:27 [INFO] Initializing Ollama connection manager...
2025-08-24 21:15:27 [WARNING] HostHealthMonitor initialized with empty host list
2025-08-24 21:15:27 [INFO] Setting up connections...
2025-08-24 21:15:27 [INFO] Multi-GPU configuration: 4 instances
2025-08-24 21:15:27 [INFO] Initialized with 4 hosts
2025-08-24 21:15:27 [INFO] Waiting for Ollama services to start...
2025-08-24 21:15:27 [INFO] Checking host 1/4: http://127.0.0.1:39001
2025-08-24 21:15:27 [INFO] Host http://127.0.0.1:39001 is ready
2025-08-24 21:15:27 [INFO] Checking host 2/4: http://127.0.0.1:39002
2025-08-24 21:15:27 [INFO] Host http://127.0.0.1:39002 is ready
2025-08-24 21:15:27 [INFO] Checking host 3/4: http://127.0.0.1:39003
2025-08-24 21:15:27 [INFO] Host http://127.0.0.1:39003 is ready
2025-08-24 21:15:27 [INFO] Checking host 4/4: http://127.0.0.1:39004
2025-08-24 21:15:27 [INFO] Host http://127.0.0.1:39004 is ready
2025-08-24 21:15:27 [INFO] All Ollama services are ready!
2025-08-24 21:15:27 [INFO] Loaded 5150 completed cards from checkpoint
2025-08-24 21:15:27 [INFO] File veronacard_2022_original has 5150 completed cards
2025-08-24 21:15:27 [INFO] Processing veronacard_2022_original.csv
2025-08-24 21:15:27 [INFO] Loaded 5150 completed cards from checkpoint
2025-08-24 21:15:27 [INFO] Loading and preprocessing data...
2025-08-24 21:15:27 [INFO] Loaded 22 POIs from vc_site.csv
2025-08-24 21:15:29 [INFO] Loaded 382346 visits from veronacard_2022_original.csv
2025-08-24 21:15:29 [INFO] Valid visits after merge: 381361
2025-08-24 21:15:29 [INFO] Multi-visit cards: 84988 / 89775
2025-08-24 21:15:29 [INFO] Performing user clustering...
2025-08-24 21:15:36 [INFO] Processing 67754 cards
2025-08-24 21:15:36 [INFO] Using 4 workers for 4 healthy hosts
2025-08-24 21:15:36 [INFO] Waiting 120s for models to FULLY stabilize...

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
📊 GPU STATUS - 2025-08-24 21:15:58
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
GPU 0: 💤 IDLE
  Compute:   0% | Memory:   0% ( 26098/ 65536 MB)
  Temp: 43°C | Power:  77.79 W

GPU 1: 💤 IDLE
  Compute:   0% | Memory:   0% ( 26098/ 65536 MB)
  Temp: 44°C | Power:  77.28 W

GPU 2: 💤 IDLE
  Compute:   0% | Memory:   0% ( 26098/ 65536 MB)
  Temp: 43°C | Power:  74.27 W

GPU 3: 💤 IDLE
  Compute:   0% | Memory:   0% ( 26098/ 65536 MB)
  Temp: 43°C | Power:  75.64 W

🔄 Processi Ollama:
  GPU 0 (PID 3581664): ✅ CPU: 5.6% | RAM: 1.0GB | Port: 39001
    └─ API: ✅ Responsive
  GPU 1 (PID 3581994): ✅ CPU: 8.2% | RAM: 1.0GB | Port: 39002
    └─ API: ✅ Responsive
  GPU 2 (PID 3582034): ✅ CPU: 9.6% | RAM: 1.0GB | Port: 39003
    └─ API: ✅ Responsive
  GPU 3 (PID 3582072): ✅ CPU: 11.7% | RAM: 1.0GB | Port: 39004
    └─ API: ✅ Responsive

🐍 Python Processing:
  Output files: 6
  Latest: dati_2015_pred_20250823_170255.csv (23M)
  Cards processed: 0
0
  Errors: 0
0
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
📊 GPU STATUS - 2025-08-24 21:16:58
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
GPU 0: 💤 IDLE
  Compute:   0% | Memory:   0% ( 26098/ 65536 MB)
  Temp: 43°C | Power:  78.13 W

GPU 1: 💤 IDLE
  Compute:   0% | Memory:   0% ( 26098/ 65536 MB)
  Temp: 44°C | Power:  77.28 W

GPU 2: 💤 IDLE
  Compute:   0% | Memory:   0% ( 26098/ 65536 MB)
  Temp: 43°C | Power:  74.27 W

GPU 3: 💤 IDLE
  Compute:   0% | Memory:   0% ( 26098/ 65536 MB)
  Temp: 43°C | Power:  75.64 W

🔄 Processi Ollama:
  GPU 0 (PID 3581664): ✅ CPU: 4.9% | RAM: 1.0GB | Port: 39001
    └─ API: ✅ Responsive
  GPU 1 (PID 3581994): ✅ CPU: 6.6% | RAM: 1.0GB | Port: 39002
    └─ API: ✅ Responsive
  GPU 2 (PID 3582034): ✅ CPU: 7.5% | RAM: 1.0GB | Port: 39003
    └─ API: ✅ Responsive
  GPU 3 (PID 3582072): ✅ CPU: 8.8% | RAM: 1.0GB | Port: 39004
    └─ API: ✅ Responsive

🐍 Python Processing:
  Output files: 6
  Latest: dati_2015_pred_20250823_170255.csv (23M)
  Cards processed: 0
0
  Errors: 0
0
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
2025-08-24 21:17:36 [INFO] Running pre-flight check on all hosts...
2025-08-24 21:17:49 [INFO] ✅ Pre-flight check passed for http://127.0.0.1:39001
2025-08-24 21:17:52 [INFO] ✅ Pre-flight check passed for http://127.0.0.1:39002

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
📊 GPU STATUS - 2025-08-24 21:17:59
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
2025-08-24 21:17:59 [INFO] ✅ Pre-flight check passed for http://127.0.0.1:39003
GPU 0: 💤 IDLE
  Compute:   0% | Memory:   0% ( 5460/ 65536 MB)
  Temp: 43°C | Power:  77.79 W

GPU 1: 💤 IDLE
  Compute:   0% | Memory:   0% ( 5460/ 65536 MB)
  Temp: 44°C | Power:  77.28 W

GPU 2: 💤 IDLE
  Compute:   0% | Memory:   0% ( 5460/ 65536 MB)
  Temp: 43°C | Power:  74.27 W

GPU 3: 💤 IDLE
  Compute:   0% | Memory:   0% ( 26098/ 65536 MB)
  Temp: 43°C | Power:  75.64 W

🔄 Processi Ollama:
  GPU 0 (PID 3581664): ✅ CPU: 4.4% | RAM: 1.0GB | Port: 39001
    └─ API: ✅ Responsive
  GPU 1 (PID 3581994): ✅ CPU: 5.7% | RAM: 1.0GB | Port: 39002
    └─ API: ✅ Responsive
  GPU 2 (PID 3582034): ✅ CPU: 6.3% | RAM: 1.0GB | Port: 39003
    └─ API: ✅ Responsive
  GPU 3 (PID 3582072): ✅ CPU: 7.1% | RAM: 1.0GB | Port: 39004
    └─ API: ✅ Responsive

🐍 Python Processing:
  Output files: 6
  Latest: dati_2015_pred_20250823_170255.csv (23M)
  Cards processed: 0
0
  Errors: 0
0
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
2025-08-24 21:18:03 [INFO] ✅ Pre-flight check passed for http://127.0.0.1:39004

Processing cards:   0%|          | 0/67754 [00:00<?, ?card/s]
Processing cards:   0%|          | 1/67754 [00:02<56:19:44,  2.99s/card]
Processing cards:   0%|          | 2/67754 [00:03<33:54:53,  1.80s/card]