2025-09-09 09:06:36 [INFO] Initializing Ollama connection manager...
2025-09-09 09:06:36 [WARNING] HostHealthMonitor initialized with empty host list
2025-09-09 09:06:36 [INFO] Setting up connections...
2025-09-09 09:06:36 [INFO] Multi-GPU configuration: 4 instances
2025-09-09 09:06:36 [INFO] Initialized with 4 hosts
2025-09-09 09:06:36 [INFO] Waiting for Ollama services to start...
2025-09-09 09:06:36 [INFO] Checking host 1/4: http://127.0.0.1:39001
2025-09-09 09:06:36 [INFO] Host http://127.0.0.1:39001 is ready
2025-09-09 09:06:36 [INFO] Checking host 2/4: http://127.0.0.1:39002
2025-09-09 09:06:36 [INFO] Host http://127.0.0.1:39002 is ready
2025-09-09 09:06:36 [INFO] Checking host 3/4: http://127.0.0.1:39003
2025-09-09 09:06:36 [INFO] Host http://127.0.0.1:39003 is ready
2025-09-09 09:06:36 [INFO] Checking host 4/4: http://127.0.0.1:39004
2025-09-09 09:06:36 [INFO] Host http://127.0.0.1:39004 is ready
2025-09-09 09:06:36 [INFO] All Ollama services are ready!
2025-09-09 09:06:36 [INFO] Found 12 files to process
2025-09-09 09:06:36 [INFO] Loaded 65892 completed cards from checkpoint
2025-09-09 09:06:36 [INFO] File dati_2014 has 65892 completed cards
2025-09-09 09:06:37 [INFO] Loaded 65892 completed cards from checkpoint
2025-09-09 09:06:37 [INFO] File dati_2014 has 65892 completed cards
2025-09-09 09:06:37 [INFO] Processing dati_2014.csv
2025-09-09 09:06:37 [INFO] Loaded 65892 completed cards from checkpoint
2025-09-09 09:06:37 [INFO] Loading and preprocessing data...
2025-09-09 09:06:37 [INFO] Loaded 22 POIs from vc_site.csv
2025-09-09 09:06:39 [INFO] Loaded 370377 visits from dati_2014.csv
2025-09-09 09:06:39 [INFO] Valid visits after merge: 370377
2025-09-09 09:06:39 [INFO] Multi-visit cards: 70236 / 71557
2025-09-09 09:06:39 [INFO] Performing user clustering...
2025-09-09 09:06:46 [INFO] Processing 0 cards
2025-09-09 09:06:46 [INFO] No cards to process
2025-09-09 09:06:46 [INFO] Loaded 44184 completed cards from checkpoint
2025-09-09 09:06:46 [INFO] File dati_2015 has 44184 completed cards
2025-09-09 09:06:46 [INFO] Loaded 44184 completed cards from checkpoint
2025-09-09 09:06:46 [INFO] File dati_2015 has 44184 completed cards
2025-09-09 09:06:46 [INFO] Processing dati_2015.csv
2025-09-09 09:06:46 [INFO] Loaded 44184 completed cards from checkpoint
2025-09-09 09:06:46 [INFO] Loading and preprocessing data...
2025-09-09 09:06:46 [INFO] Loaded 22 POIs from vc_site.csv
2025-09-09 09:06:47 [INFO] Loaded 369588 visits from dati_2015.csv
2025-09-09 09:06:47 [INFO] Valid visits after merge: 369588
2025-09-09 09:06:47 [INFO] Multi-visit cards: 71759 / 73424
2025-09-09 09:06:47 [INFO] Performing user clustering...
2025-09-09 09:06:54 [INFO] Processing 22493 cards
2025-09-09 09:06:54 [INFO] Using 12 workers for 4 healthy hosts
2025-09-09 09:06:54 [INFO] Waiting 60s for model stabilization...
2025-09-09 09:07:54 [INFO] Running pre-flight check on all hosts...
2025-09-09 09:07:54 [INFO] ✅ Pre-flight check passed for http://127.0.0.1:39001
2025-09-09 09:07:54 [INFO] ✅ Pre-flight check passed for http://127.0.0.1:39002
2025-09-09 09:07:54 [INFO] ✅ Pre-flight check passed for http://127.0.0.1:39003
2025-09-09 09:07:54 [INFO] ✅ Pre-flight check passed for http://127.0.0.1:39004
2025-09-09 09:51:20 [WARNING] Incomplete response from http://127.0.0.1:39002
2025-09-09 10:43:47 [WARNING] Incomplete response from http://127.0.0.1:39002
2025-09-09 10:43:51 [WARNING] Incomplete response from http://127.0.0.1:39002
2025-09-09 10:58:03 [INFO] Completed processing dati_2015.csv
2025-09-09 10:58:03 [INFO] Success rate: 100.0%
2025-09-09 10:58:03 [INFO] Processing dati_2016.csv
2025-09-09 10:58:03 [INFO] Loading and preprocessing data...
2025-09-09 10:58:03 [INFO] Loaded 22 POIs from vc_site.csv
2025-09-09 10:58:05 [INFO] Loaded 383517 visits from dati_2016.csv
2025-09-09 10:58:05 [INFO] Valid visits after merge: 383517
2025-09-09 10:58:05 [INFO] Multi-visit cards: 76452 / 78152
2025-09-09 10:58:05 [INFO] Performing user clustering...
2025-09-09 10:58:12 [INFO] Processing 70266 cards
2025-09-09 10:58:12 [INFO] Using 12 workers for 4 healthy hosts
2025-09-09 10:58:12 [INFO] Waiting 60s for model stabilization...
2025-09-09 10:59:12 [INFO] Running pre-flight check on all hosts...
2025-09-09 11:00:12 [WARNING] Pre-flight check error for http://127.0.0.1:39001: HTTPConnectionPool(host='127.0.0.1', port=39001): Read timed out. (read timeout=60)
2025-09-09 11:01:12 [WARNING] Pre-flight check error for http://127.0.0.1:39002: HTTPConnectionPool(host='127.0.0.1', port=39002): Read timed out. (read timeout=60)
2025-09-09 11:02:03 [INFO] ✅ Pre-flight check passed for http://127.0.0.1:39003
2025-09-09 11:03:03 [INFO] ✅ Pre-flight check passed for http://127.0.0.1:39004
2025-09-09 11:50:34 [WARNING] Incomplete response from http://127.0.0.1:39004
2025-09-09 12:14:50 [WARNING] Incomplete response from http://127.0.0.1:39003
2025-09-09 12:41:08 [WARNING] Incomplete response from http://127.0.0.1:39001
2025-09-09 13:08:19 [WARNING] Incomplete response from http://127.0.0.1:39002
2025-09-09 13:43:36 [WARNING] Incomplete response from http://127.0.0.1:39001
2025-09-09 13:43:40 [WARNING] Incomplete response from http://127.0.0.1:39001
2025-09-09 13:44:02 [WARNING] Incomplete response from http://127.0.0.1:39003
2025-09-09 14:09:33 [WARNING] Incomplete response from http://127.0.0.1:39003
2025-09-09 14:09:36 [WARNING] Incomplete response from http://127.0.0.1:39004
2025-09-09 14:34:03 [WARNING] Incomplete response from http://127.0.0.1:39001
2025-09-09 15:28:44 [WARNING] Incomplete response from http://127.0.0.1:39002
2025-09-09 15:34:40 [WARNING] Invalid JSON response for 049DA0C27B3F80
2025-09-09 16:44:27 [INFO] Completed processing dati_2016.csv
2025-09-09 16:44:27 [INFO] Success rate: 100.0%
2025-09-09 16:44:27 [INFO] Processing dati_2017.csv
2025-09-09 16:44:27 [INFO] Loading and preprocessing data...
2025-09-09 16:44:27 [INFO] Loaded 22 POIs from vc_site.csv
2025-09-09 16:44:29 [INFO] Loaded 441595 visits from dati_2017.csv
2025-09-09 16:44:29 [INFO] Valid visits after merge: 441595
2025-09-09 16:44:30 [INFO] Multi-visit cards: 89352 / 91555
2025-09-09 16:44:30 [INFO] Performing user clustering...
2025-09-09 16:44:37 [INFO] Processing 81342 cards
2025-09-09 16:44:37 [INFO] Using 12 workers for 4 healthy hosts
2025-09-09 16:44:37 [INFO] Waiting 60s for model stabilization...
2025-09-09 16:45:37 [INFO] Running pre-flight check on all hosts...
2025-09-09 16:46:14 [INFO] ✅ Pre-flight check passed for http://127.0.0.1:39001
2025-09-09 16:46:44 [INFO] ✅ Pre-flight check passed for http://127.0.0.1:39002
2025-09-09 16:47:13 [INFO] ✅ Pre-flight check passed for http://127.0.0.1:39003
2025-09-09 16:47:43 [INFO] ✅ Pre-flight check passed for http://127.0.0.1:39004
2025-09-09 17:33:59 [WARNING] Incomplete response from http://127.0.0.1:39004
2025-09-09 20:50:33 [WARNING] Incomplete response from http://127.0.0.1:39003
2025-09-09 22:27:51 [WARNING] Incomplete response from http://127.0.0.1:39004
2025-09-09 22:54:11 [WARNING] Incomplete response from http://127.0.0.1:39003
2025-09-09 23:21:18 [INFO] Completed processing dati_2017.csv
2025-09-09 23:21:18 [INFO] Success rate: 100.0%
2025-09-09 23:21:18 [INFO] Processing dati_2018.csv
2025-09-09 23:21:18 [INFO] Loading and preprocessing data...
2025-09-09 23:21:18 [INFO] Loaded 22 POIs from vc_site.csv
2025-09-09 23:21:20 [INFO] Loaded 427214 visits from dati_2018.csv
2025-09-09 23:21:20 [INFO] Valid visits after merge: 427214
2025-09-09 23:21:20 [INFO] Multi-visit cards: 86222 / 88627
2025-09-09 23:21:20 [INFO] Performing user clustering...
2025-09-09 23:21:29 [INFO] Processing 78385 cards
2025-09-09 23:21:29 [INFO] Using 12 workers for 4 healthy hosts
2025-09-09 23:21:29 [INFO] Waiting 60s for model stabilization...
2025-09-09 23:22:29 [INFO] Running pre-flight check on all hosts...
2025-09-09 23:23:29 [WARNING] Pre-flight check error for http://127.0.0.1:39001: HTTPConnectionPool(host='127.0.0.1', port=39001): Read timed out. (read timeout=60)
2025-09-09 23:23:57 [INFO] ✅ Pre-flight check passed for http://127.0.0.1:39002
2025-09-09 23:24:22 [INFO] ✅ Pre-flight check passed for http://127.0.0.1:39003
2025-09-09 23:25:22 [WARNING] Pre-flight check error for http://127.0.0.1:39004: HTTPConnectionPool(host='127.0.0.1', port=39004): Read timed out. (read timeout=60)
2025-09-09 23:54:30 [WARNING] Incomplete response from http://127.0.0.1:39004
2025-09-10 01:22:10 [WARNING] Incomplete response from http://127.0.0.1:39003
2025-09-10 04:19:54 [WARNING] Incomplete response from http://127.0.0.1:39002
2025-09-10 05:00:18 [WARNING] Incomplete response from http://127.0.0.1:39002
2025-09-10 05:43:02 [INFO] Completed processing dati_2018.csv
2025-09-10 05:43:02 [INFO] Success rate: 100.0%
2025-09-10 05:43:02 [INFO] Processing dati_2019.csv
2025-09-10 05:43:02 [INFO] Loading and preprocessing data...
2025-09-10 05:43:02 [INFO] Loaded 22 POIs from vc_site.csv
2025-09-10 05:43:03 [INFO] Loaded 397562 visits from dati_2019.csv
2025-09-10 05:43:03 [INFO] Valid visits after merge: 397562
2025-09-10 05:43:04 [INFO] Multi-visit cards: 77583 / 79825
2025-09-10 05:43:04 [INFO] Performing user clustering...
2025-09-10 05:43:11 [INFO] Processing 71226 cards
2025-09-10 05:43:11 [INFO] Using 12 workers for 4 healthy hosts
2025-09-10 05:43:11 [INFO] Waiting 60s for model stabilization...
2025-09-10 05:44:11 [INFO] Running pre-flight check on all hosts...
2025-09-10 05:44:17 [INFO] ✅ Pre-flight check passed for http://127.0.0.1:39001
2025-09-10 05:44:24 [INFO] ✅ Pre-flight check passed for http://127.0.0.1:39002
2025-09-10 05:44:30 [INFO] ✅ Pre-flight check passed for http://127.0.0.1:39003
2025-09-10 05:44:43 [INFO] ✅ Pre-flight check passed for http://127.0.0.1:39004
2025-09-10 07:27:18 [WARNING] Incomplete response from http://127.0.0.1:39001
2025-09-10 07:27:29 [WARNING] Incomplete response from http://127.0.0.1:39003
2025-09-10 07:53:34 [WARNING] Incomplete response from http://127.0.0.1:39004
2025-09-10 09:08:48 [WARNING] Incomplete response from http://127.0.0.1:39003
2025-09-10 09:56:21 [WARNING] Incomplete response from http://127.0.0.1:39003
2025-09-10 10:00:13 [WARNING] Incomplete response from http://127.0.0.1:39003
2025-09-10 11:06:19 [WARNING] Incomplete response from http://127.0.0.1:39002
2025-09-10 11:28:59 [INFO] Completed processing dati_2019.csv
2025-09-10 11:28:59 [INFO] Success rate: 100.0%
2025-09-10 11:28:59 [INFO] Processing dati_2020.csv
2025-09-10 11:28:59 [INFO] Loading and preprocessing data...
2025-09-10 11:28:59 [INFO] Loaded 22 POIs from vc_site.csv
2025-09-10 11:28:59 [INFO] Loaded 38294 visits from dati_2020.csv
2025-09-10 11:28:59 [INFO] Valid visits after merge: 38294
2025-09-10 11:28:59 [INFO] Multi-visit cards: 7658 / 7914
2025-09-10 11:28:59 [INFO] Performing user clustering...
2025-09-10 11:29:02 [INFO] Processing 6969 cards
2025-09-10 11:29:02 [INFO] Using 12 workers for 4 healthy hosts
2025-09-10 11:29:02 [INFO] Waiting 60s for model stabilization...
2025-09-10 11:30:02 [INFO] Running pre-flight check on all hosts...
2025-09-10 11:30:17 [INFO] ✅ Pre-flight check passed for http://127.0.0.1:39001
2025-09-10 11:30:23 [INFO] ✅ Pre-flight check passed for http://127.0.0.1:39002
2025-09-10 11:30:40 [INFO] ✅ Pre-flight check passed for http://127.0.0.1:39003
2025-09-10 11:30:52 [INFO] ✅ Pre-flight check passed for http://127.0.0.1:39004
2025-09-10 12:04:35 [INFO] Completed processing dati_2020.csv
2025-09-10 12:04:35 [INFO] Success rate: 100.0%
2025-09-10 12:04:35 [INFO] Processing veronacard_2019_original.csv
2025-09-10 12:04:35 [INFO] Loading and preprocessing data...
2025-09-10 12:04:35 [INFO] Loaded 22 POIs from vc_site.csv
2025-09-10 12:04:36 [INFO] Loaded 397563 visits from veronacard_2019_original.csv
2025-09-10 12:04:36 [INFO] Valid visits after merge: 397563
2025-09-10 12:04:36 [INFO] Multi-visit cards: 77583 / 79826
2025-09-10 12:04:36 [INFO] Performing user clustering...
2025-09-10 12:04:43 [INFO] Processing 71226 cards
2025-09-10 12:04:43 [INFO] Using 12 workers for 4 healthy hosts
2025-09-10 12:04:43 [INFO] Waiting 60s for model stabilization...
2025-09-10 12:05:43 [INFO] Running pre-flight check on all hosts...
2025-09-10 12:05:50 [INFO] ✅ Pre-flight check passed for http://127.0.0.1:39001
2025-09-10 12:05:56 [INFO] ✅ Pre-flight check passed for http://127.0.0.1:39002
2025-09-10 12:06:10 [INFO] ✅ Pre-flight check passed for http://127.0.0.1:39003
2025-09-10 12:06:23 [INFO] ✅ Pre-flight check passed for http://127.0.0.1:39004
2025-09-10 12:10:32 [WARNING] Incomplete response from http://127.0.0.1:39001
2025-09-10 14:52:57 [WARNING] Incomplete response from http://127.0.0.1:39003
2025-09-10 16:17:21 [WARNING] Incomplete response from http://127.0.0.1:39002
2025-09-10 16:18:45 [WARNING] Incomplete response from http://127.0.0.1:39003
2025-09-10 17:29:29 [WARNING] Incomplete response from http://127.0.0.1:39001
2025-09-10 17:48:16 [INFO] Completed processing veronacard_2019_original.csv
2025-09-10 17:48:16 [INFO] Success rate: 100.0%
2025-09-10 17:48:16 [INFO] Processing veronacard_2020_original.csv
2025-09-10 17:48:16 [INFO] Loading and preprocessing data...
2025-09-10 17:48:16 [INFO] Loaded 22 POIs from vc_site.csv
2025-09-10 17:48:16 [INFO] Loaded 38304 visits from veronacard_2020_original.csv
2025-09-10 17:48:16 [INFO] Valid visits after merge: 38304
2025-09-10 17:48:16 [INFO] Multi-visit cards: 7660 / 7914
2025-09-10 17:48:16 [INFO] Performing user clustering...
2025-09-10 17:48:18 [INFO] Processing 6971 cards
2025-09-10 17:48:18 [INFO] Using 12 workers for 4 healthy hosts
2025-09-10 17:48:18 [INFO] Waiting 60s for model stabilization...
2025-09-10 17:49:18 [INFO] Running pre-flight check on all hosts...
2025-09-10 17:49:33 [INFO] ✅ Pre-flight check passed for http://127.0.0.1:39001
2025-09-10 17:49:40 [INFO] ✅ Pre-flight check passed for http://127.0.0.1:39002
2025-09-10 17:49:53 [INFO] ✅ Pre-flight check passed for http://127.0.0.1:39003
2025-09-10 17:50:00 [INFO] ✅ Pre-flight check passed for http://127.0.0.1:39004
2025-09-10 18:24:09 [INFO] Completed processing veronacard_2020_original.csv
2025-09-10 18:24:09 [INFO] Success rate: 100.0%
2025-09-10 18:24:09 [INFO] Processing veronacard_2021_original.csv
2025-09-10 18:24:09 [INFO] Loading and preprocessing data...
2025-09-10 18:24:09 [INFO] Loaded 22 POIs from vc_site.csv
2025-09-10 18:24:10 [INFO] Loaded 115814 visits from veronacard_2021_original.csv
2025-09-10 18:24:10 [INFO] Valid visits after merge: 115814
2025-09-10 18:24:10 [INFO] Multi-visit cards: 25581 / 27032
2025-09-10 18:24:10 [INFO] Performing user clustering...
2025-09-10 18:24:15 [INFO] Processing 21983 cards
2025-09-10 18:24:15 [INFO] Using 12 workers for 4 healthy hosts
2025-09-10 18:24:15 [INFO] Waiting 60s for model stabilization...
2025-09-10 18:25:15 [INFO] Running pre-flight check on all hosts...
2025-09-10 18:26:09 [INFO] ✅ Pre-flight check passed for http://127.0.0.1:39001
2025-09-10 18:26:32 [INFO] ✅ Pre-flight check passed for http://127.0.0.1:39002
2025-09-10 18:26:54 [INFO] ✅ Pre-flight check passed for http://127.0.0.1:39003
2025-09-10 18:27:19 [INFO] ✅ Pre-flight check passed for http://127.0.0.1:39004
2025-09-10 18:28:30 [WARNING] Incomplete response from http://127.0.0.1:39004
2025-09-10 19:45:09 [WARNING] Incomplete response from http://127.0.0.1:39003
2025-09-10 20:14:26 [INFO] Completed processing veronacard_2021_original.csv
2025-09-10 20:14:26 [INFO] Success rate: 100.0%
2025-09-10 20:14:26 [INFO] Processing veronacard_2022_original.csv
2025-09-10 20:14:26 [INFO] Loading and preprocessing data...
2025-09-10 20:14:26 [INFO] Loaded 22 POIs from vc_site.csv
2025-09-10 20:14:30 [INFO] Loaded 382346 visits from veronacard_2022_original.csv
2025-09-10 20:14:31 [INFO] Valid visits after merge: 381361
2025-09-10 20:14:31 [INFO] Multi-visit cards: 84988 / 89775
2025-09-10 20:14:31 [INFO] Performing user clustering...
2025-09-10 20:14:39 [INFO] Processing 72904 cards
2025-09-10 20:14:39 [INFO] Using 12 workers for 4 healthy hosts
2025-09-10 20:14:39 [INFO] Waiting 60s for model stabilization...
2025-09-10 20:15:39 [INFO] Running pre-flight check on all hosts...
2025-09-10 20:15:45 [INFO] ✅ Pre-flight check passed for http://127.0.0.1:39001
2025-09-10 20:15:52 [INFO] ✅ Pre-flight check passed for http://127.0.0.1:39002
2025-09-10 20:15:58 [INFO] ✅ Pre-flight check passed for http://127.0.0.1:39003
2025-09-10 20:16:05 [INFO] ✅ Pre-flight check passed for http://127.0.0.1:39004
2025-09-10 20:39:30 [WARNING] Incomplete response from http://127.0.0.1:39002
2025-09-10 22:43:56 [WARNING] Incomplete response from http://127.0.0.1:39001
