2025-09-05 07:50:20 [INFO] Initializing Ollama connection manager...
2025-09-05 07:50:20 [WARNING] HostHealthMonitor initialized with empty host list
2025-09-05 07:50:20 [INFO] Setting up connections...
2025-09-05 07:50:20 [INFO] Multi-GPU configuration: 4 instances
2025-09-05 07:50:20 [INFO] Initialized with 4 hosts
2025-09-05 07:50:20 [INFO] Waiting for Ollama services to start...
2025-09-05 07:50:20 [INFO] Checking host 1/4: http://127.0.0.1:39001
2025-09-05 07:50:20 [INFO] Host http://127.0.0.1:39001 is ready
2025-09-05 07:50:20 [INFO] Checking host 2/4: http://127.0.0.1:39002
2025-09-05 07:50:20 [INFO] Host http://127.0.0.1:39002 is ready
2025-09-05 07:50:20 [INFO] Checking host 3/4: http://127.0.0.1:39003
2025-09-05 07:50:20 [INFO] Host http://127.0.0.1:39003 is ready
2025-09-05 07:50:20 [INFO] Checking host 4/4: http://127.0.0.1:39004
2025-09-05 07:50:20 [INFO] Host http://127.0.0.1:39004 is ready
2025-09-05 07:50:20 [INFO] All Ollama services are ready!
2025-09-05 07:50:20 [INFO] Found 12 files to process
2025-09-05 07:50:20 [INFO] Processing dati_2014.csv
2025-09-05 07:50:20 [INFO] Loading and preprocessing data...
2025-09-05 07:50:21 [INFO] Loaded 22 POIs from vc_site.csv
2025-09-05 07:50:23 [INFO] Loaded 370377 visits from dati_2014.csv
2025-09-05 07:50:23 [INFO] Valid visits after merge: 370377
2025-09-05 07:50:23 [INFO] Multi-visit cards: 70236 / 71557
2025-09-05 07:50:23 [INFO] Performing user clustering...
2025-09-05 07:50:30 [INFO] Processing 65892 cards
2025-09-05 07:50:30 [INFO] Using 1 workers for 4 healthy hosts
2025-09-05 07:50:30 [INFO] Waiting 120s for models to FULLY stabilize...
2025-09-05 07:52:30 [INFO] Running pre-flight check on all hosts...
2025-09-05 07:52:32 [INFO] âœ… Pre-flight check passed for http://127.0.0.1:39001
2025-09-05 07:52:35 [INFO] âœ… Pre-flight check passed for http://127.0.0.1:39002
2025-09-05 07:52:37 [INFO] âœ… Pre-flight check passed for http://127.0.0.1:39003
2025-09-05 07:52:40 [INFO] âœ… Pre-flight check passed for http://127.0.0.1:39004
2025-09-05 07:52:40 [INFO] âœ… ALL PRE-FLIGHT CHECKS PASSED - Starting progressive warm-up
2025-09-05 07:52:40 [INFO] ðŸ”¥ Phase 1: Single request warm-up test (30s timeout)...
2025-09-05 07:52:40 [INFO]   Testing warm-up prompt 1/3...
2025-09-05 07:52:54 [INFO]     âœ… Warm-up 1 successful: 569 chars
2025-09-05 07:52:56 [INFO]   Testing warm-up prompt 2/3...
2025-09-05 07:53:01 [INFO]     âœ… Warm-up 2 successful: 146 chars
2025-09-05 07:53:03 [INFO]   Testing warm-up prompt 3/3...
2025-09-05 07:53:26 [INFO]     âœ… Warm-up 3 successful: 1051 chars
2025-09-05 07:53:28 [INFO] ðŸ”¥ Phase 2: Concurrent requests test (2 simultaneous)...
2025-09-05 07:55:17 [ERROR] Unexpected error on http://127.0.0.1:39001: ('Connection aborted.', RemoteDisconnected('Remote end closed connection without response'))
2025-09-05 07:55:17 [ERROR] Unexpected error on http://127.0.0.1:39004: ('Connection aborted.', RemoteDisconnected('Remote end closed connection without response'))
2025-09-05 07:55:19 [ERROR] Unexpected error on http://127.0.0.1:39003: HTTPConnectionPool(host='127.0.0.1', port=39003): Max retries exceeded with url: /api/chat (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x15397d3c8f50>: Failed to establish a new connection: [Errno 111] Connection refused'))
2025-09-05 07:55:19 [ERROR] Unexpected error on http://127.0.0.1:39002: HTTPConnectionPool(host='127.0.0.1', port=39002): Max retries exceeded with url: /api/chat (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x1539803f2b90>: Failed to establish a new connection: [Errno 111] Connection refused'))
2025-09-05 07:55:23 [WARNING] No healthy hosts found, attempting recovery...
2025-09-05 07:55:23 [ERROR] No healthy hosts available
2025-09-05 07:55:23 [WARNING] No healthy hosts found, attempting recovery...
2025-09-05 07:55:23 [WARNING] Health check failed for http://127.0.0.1:39001: HTTPConnectionPool(host='127.0.0.1', port=39001): Max retries exceeded with url: /api/tags (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x15397d609ad0>: Failed to establish a new connection: [Errno 111] Connection refused'))
2025-09-05 07:55:23 [ERROR] No healthy hosts available
2025-09-05 07:55:23 [WARNING] Health check failed for http://127.0.0.1:39002: HTTPConnectionPool(host='127.0.0.1', port=39002): Max retries exceeded with url: /api/tags (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x15397d129fd0>: Failed to establish a new connection: [Errno 111] Connection refused'))
2025-09-05 07:55:23 [WARNING] Health check failed for http://127.0.0.1:39001: HTTPConnectionPool(host='127.0.0.1', port=39001): Max retries exceeded with url: /api/tags (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x15397d3c8f10>: Failed to establish a new connection: [Errno 111] Connection refused'))
2025-09-05 07:55:23 [WARNING] Health check failed for http://127.0.0.1:39003: HTTPConnectionPool(host='127.0.0.1', port=39003): Max retries exceeded with url: /api/tags (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x1539803f0110>: Failed to establish a new connection: [Errno 111] Connection refused'))
2025-09-05 07:55:23 [WARNING] Health check failed for http://127.0.0.1:39002: HTTPConnectionPool(host='127.0.0.1', port=39002): Max retries exceeded with url: /api/tags (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x15397c23ae90>: Failed to establish a new connection: [Errno 111] Connection refused'))
2025-09-05 07:55:23 [WARNING] Health check failed for http://127.0.0.1:39004: HTTPConnectionPool(host='127.0.0.1', port=39004): Max retries exceeded with url: /api/tags (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x15397d3ca050>: Failed to establish a new connection: [Errno 111] Connection refused'))
2025-09-05 07:55:23 [WARNING] No healthy hosts found, attempting recovery...
2025-09-05 07:55:23 [WARNING] Health check failed for http://127.0.0.1:39003: HTTPConnectionPool(host='127.0.0.1', port=39003): Max retries exceeded with url: /api/tags (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x15397d791c90>: Failed to establish a new connection: [Errno 111] Connection refused'))
2025-09-05 07:55:23 [ERROR] Request failed completely: All hosts are down
2025-09-05 07:55:23 [WARNING] Health check failed for http://127.0.0.1:39004: HTTPConnectionPool(host='127.0.0.1', port=39004): Max retries exceeded with url: /api/tags (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x153980082890>: Failed to establish a new connection: [Errno 111] Connection refused'))
2025-09-05 07:55:23 [WARNING] No healthy hosts found, attempting recovery...
2025-09-05 07:55:23 [ERROR] Request failed completely: All hosts are down
2025-09-05 07:55:23 [ERROR] Error processing dati_2014.csv: 2 (of 2) futures unfinished
2025-09-05 07:55:23 [ERROR] Error processing dati_2014.csv: 2 (of 2) futures unfinished
2025-09-05 07:55:23 [INFO] Processing dati_2015.csv
2025-09-05 07:55:23 [INFO] Loading and preprocessing data...
2025-09-05 07:55:23 [INFO] Loaded 22 POIs from vc_site.csv
2025-09-05 07:55:25 [INFO] Loaded 369588 visits from dati_2015.csv
2025-09-05 07:55:25 [INFO] Valid visits after merge: 369588
2025-09-05 07:55:25 [INFO] Multi-visit cards: 71759 / 73424
2025-09-05 07:55:25 [INFO] Performing user clustering...
