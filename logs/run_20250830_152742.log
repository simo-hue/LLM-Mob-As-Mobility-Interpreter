2025-08-30 15:27:42 [INFO] Initializing Ollama connection manager...
2025-08-30 15:27:42 [WARNING] HostHealthMonitor initialized with empty host list
2025-08-30 15:27:42 [INFO] Setting up connections...
2025-08-30 15:27:42 [INFO] Multi-GPU configuration: 4 instances
2025-08-30 15:27:42 [INFO] Initialized with 4 hosts
2025-08-30 15:27:42 [INFO] Waiting for Ollama services to start...
2025-08-30 15:27:42 [INFO] Checking host 1/4: http://127.0.0.1:39001
2025-08-30 15:27:42 [INFO] Host http://127.0.0.1:39001 is ready
2025-08-30 15:27:42 [INFO] Checking host 2/4: http://127.0.0.1:39002
2025-08-30 15:27:42 [INFO] Host http://127.0.0.1:39002 is ready
2025-08-30 15:27:42 [INFO] Checking host 3/4: http://127.0.0.1:39003
2025-08-30 15:27:42 [INFO] Host http://127.0.0.1:39003 is ready
2025-08-30 15:27:42 [INFO] Checking host 4/4: http://127.0.0.1:39004
2025-08-30 15:27:42 [INFO] Host http://127.0.0.1:39004 is ready
2025-08-30 15:27:42 [INFO] All Ollama services are ready!
2025-08-30 15:27:42 [INFO] Found 12 files to process
2025-08-30 15:27:43 [INFO] Loaded 65892 completed cards from checkpoint
2025-08-30 15:27:43 [INFO] File dati_2014 has 65892 completed cards
2025-08-30 15:27:43 [INFO] Loaded 65892 completed cards from checkpoint
2025-08-30 15:27:43 [INFO] File dati_2014 has 65892 completed cards
2025-08-30 15:27:43 [INFO] Processing dati_2014.csv
2025-08-30 15:27:43 [INFO] Loaded 65892 completed cards from checkpoint
2025-08-30 15:27:43 [INFO] Loading and preprocessing data...
2025-08-30 15:27:43 [INFO] Loaded 22 POIs from vc_site.csv
2025-08-30 15:27:45 [INFO] Loaded 370377 visits from dati_2014.csv
2025-08-30 15:27:45 [INFO] Valid visits after merge: 370377
2025-08-30 15:27:45 [INFO] Multi-visit cards: 70236 / 71557
2025-08-30 15:27:45 [INFO] Performing user clustering...
2025-08-30 15:27:52 [INFO] Processing 0 cards
2025-08-30 15:27:52 [INFO] No cards to process
2025-08-30 15:27:52 [INFO] Loaded 50087 completed cards from checkpoint
2025-08-30 15:27:52 [INFO] File dati_2015 has 50087 completed cards
2025-08-30 15:27:52 [INFO] Loaded 50087 completed cards from checkpoint
2025-08-30 15:27:52 [INFO] File dati_2015 has 50087 completed cards
2025-08-30 15:27:52 [INFO] Processing dati_2015.csv
2025-08-30 15:27:52 [INFO] Loaded 50087 completed cards from checkpoint
2025-08-30 15:27:52 [INFO] Loading and preprocessing data...
2025-08-30 15:27:52 [INFO] Loaded 22 POIs from vc_site.csv
2025-08-30 15:27:53 [INFO] Loaded 369588 visits from dati_2015.csv
2025-08-30 15:27:53 [INFO] Valid visits after merge: 369588
2025-08-30 15:27:53 [INFO] Multi-visit cards: 71759 / 73424
2025-08-30 15:27:53 [INFO] Performing user clustering...
2025-08-30 15:28:00 [INFO] Processing 16590 cards
2025-08-30 15:28:00 [INFO] Using 8 workers for 4 healthy hosts
2025-08-30 15:28:00 [INFO] Waiting 120s for models to FULLY stabilize...
2025-08-30 15:30:00 [INFO] Running pre-flight check on all hosts...
2025-08-30 15:30:55 [INFO] ✅ Pre-flight check passed for http://127.0.0.1:39001
2025-08-30 15:31:54 [INFO] ✅ Pre-flight check passed for http://127.0.0.1:39002
2025-08-30 15:32:54 [WARNING] Pre-flight check error for http://127.0.0.1:39003: HTTPConnectionPool(host='127.0.0.1', port=39003): Read timed out. (read timeout=60)
2025-08-30 15:33:54 [WARNING] Pre-flight check error for http://127.0.0.1:39004: HTTPConnectionPool(host='127.0.0.1', port=39004): Read timed out. (read timeout=60)
2025-08-30 17:01:42 [INFO] Completed processing dati_2015.csv
2025-08-30 17:01:42 [INFO] Success rate: 100.0%
2025-08-30 17:01:42 [INFO] Processing dati_2016.csv
2025-08-30 17:01:42 [INFO] Loading and preprocessing data...
2025-08-30 17:01:42 [INFO] Loaded 22 POIs from vc_site.csv
2025-08-30 17:01:44 [INFO] Loaded 383517 visits from dati_2016.csv
2025-08-30 17:01:44 [INFO] Valid visits after merge: 383517
2025-08-30 17:01:44 [INFO] Multi-visit cards: 76452 / 78152
2025-08-30 17:01:44 [INFO] Performing user clustering...
2025-08-30 17:01:51 [INFO] Processing 70266 cards
2025-08-30 17:01:51 [INFO] Using 8 workers for 4 healthy hosts
2025-08-30 17:01:51 [INFO] Waiting 120s for models to FULLY stabilize...
2025-08-30 17:03:51 [INFO] Running pre-flight check on all hosts...
2025-08-30 17:04:44 [INFO] ✅ Pre-flight check passed for http://127.0.0.1:39001
2025-08-30 17:05:30 [INFO] ✅ Pre-flight check passed for http://127.0.0.1:39002
2025-08-30 17:06:21 [INFO] ✅ Pre-flight check passed for http://127.0.0.1:39003
2025-08-30 17:07:12 [INFO] ✅ Pre-flight check passed for http://127.0.0.1:39004
